# FoliaShop - é«˜ç‰ˆæœ¬Folia/Paperç³»ç»Ÿå•†åº—ä¸æ‰­è›‹æ’ä»¶

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Folia](https://img.shields.io/badge/Folia-1.21+-blue.svg)](https://github.com/PaperMC/Folia)

ä¸€ä¸ªä¸“ä¸º [Folia/Paper](https://github.com/PaperMC/Folia) æœåŠ¡ç«¯è®¾è®¡çš„ç³»ç»Ÿå•†åº—å’Œæ‰­è›‹æ’ä»¶ï¼Œæ”¯æŒåŸç‰ˆç‰©å“å’Œ [CraftEngine](https://github.com/Momirealms/CraftEngine) è‡ªå®šä¹‰ç‰©å“ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ç³»ç»Ÿå•†åº—
- ğŸ›’ æ”¯æŒè´­ä¹°å’Œå‡ºå”®ç‰©å“
- ğŸ“‚ å•†å“åˆ†ç±»ç®¡ç†
- ğŸ“¦ åº“å­˜ç³»ç»Ÿï¼ˆæ”¯æŒæ— é™åº“å­˜ï¼‰
- ğŸ”§ æ”¯æŒ CraftEngine è‡ªå®šä¹‰ç‰©å“ï¼ˆCEç‰©å“ï¼‰
- ğŸ“œ äº¤æ˜“è®°å½•ï¼ˆç©å®¶å¯æŸ¥è¯¢æœ€è¿‘20æ¬¡ï¼‰
- â° **æ¯æ—¥è´­ä¹°é™é¢**ï¼ˆæ¯ä¸ªç‰©å“ç‹¬ç«‹é…ç½®ï¼‰

### æ‰­è›‹ç³»ç»Ÿ
- ğŸ° å¤šæ‰­è›‹æœºæ”¯æŒ
- ğŸ¯ æ¦‚ç‡é…ç½®
- ğŸ”§ æ”¯æŒ CraftEngine è‡ªå®šä¹‰ç‰©å“ï¼ˆCEç‰©å“ï¼‰
- âœ¨ æŠ½å¥–åŠ¨ç”»ï¼ˆå•æŠ½ + 10è¿æŠ½ï¼‰
- ğŸ›¡ï¸ **å¤šæ®µä¿åº•ç³»ç»Ÿ**ï¼ˆæ”¯æŒå¤šæ¡£ä¿åº•è§„åˆ™ï¼‰
- ğŸ“¢ ç¨€æœ‰å¥–å“å¹¿æ’­
- ğŸ‘ï¸ å¥–å“é¢„è§ˆ
- ğŸ“Š æŠ½å¥–è®°å½•

## ğŸ“‹ ä¾èµ–è¦æ±‚

### å¿…éœ€æ’ä»¶ï¼ˆç¡¬ä¾èµ–ï¼‰
| æ’ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Folia | 1.21+ | æœåŠ¡ç«¯æ ¸å¿ƒ |
| XConomy | 2.25+ | ç»æµç³»ç»Ÿ |
| CraftEngine | 0.0.67+ | è‡ªå®šä¹‰ç‰©å“ç³»ç»Ÿ |

## ğŸš€ å®‰è£…

1. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ `folia_shop-1.0.0.jar`
2. å°† JAR æ–‡ä»¶æ”¾å…¥æœåŠ¡å™¨çš„ `plugins` æ–‡ä»¶å¤¹
3. é‡å¯æœåŠ¡å™¨æˆ–åŠ è½½æ’ä»¶
4. ç¼–è¾‘ `plugins/FoliaShop/config.yml` é…ç½®å•†åº—å’Œæ‰­è›‹
5. æ‰§è¡Œ `/foliashop reload` é‡è½½é…ç½®

## ğŸ“– å‘½ä»¤

### ç©å®¶å‘½ä»¤
| å‘½ä»¤ | æè¿° | æƒé™ |
|------|------|------|
| `/foliashop` | æ‰“å¼€ä¸»èœå• | `foliashop.use` |
| `/foliashop shop` | æ‰“å¼€ç³»ç»Ÿå•†åº— | `foliashop.shop.use` |
| `/foliashop gacha` | æ‰“å¼€æ‰­è›‹ç•Œé¢ | `foliashop.gacha.use` |
| `/shop [åˆ†ç±»]` | ç›´æ¥æ‰“å¼€å•†åº—ï¼ˆå¯æŒ‡å®šåˆ†ç±»ï¼‰ | `foliashop.shop.use` |
| `/gacha [æ‰­è›‹æœºID]` | ç›´æ¥æ‰“å¼€æ‰­è›‹ï¼ˆå¯æŒ‡å®šæœºå™¨ï¼‰ | `foliashop.gacha.use` |

### ç®¡ç†å‘˜å‘½ä»¤
| å‘½ä»¤ | æè¿° | æƒé™ |
|------|------|------|
| `/foliashop reload` | é‡è½½é…ç½®æ–‡ä»¶ | `foliashop.admin` |
| `/foliashop admin` | æ‰“å¼€å•†åº—ç®¡ç†ç•Œé¢ | `foliashop.admin` |
| `/foliashop reset` | æ¸…ç©ºæ•°æ®åº“å¹¶ä»é…ç½®é‡æ–°åŠ è½½ | `foliashop.admin` |
| `/foliashop clean <å¤©æ•°>` | æ¸…ç†æ—§æ•°æ®ï¼ˆ5/10/30å¤©ï¼‰ | `foliashop.admin` |

## ğŸ” æƒé™èŠ‚ç‚¹

### ç©å®¶æƒé™
```yaml
foliashop.use:          # ä½¿ç”¨åŸºç¡€å‘½ä»¤ï¼ˆæ‰“å¼€ä¸»èœå•ï¼‰
  default: true

foliashop.shop.use:     # ä½¿ç”¨å•†åº—åŠŸèƒ½
  default: true

foliashop.shop.sell:    # å‡ºå”®ç‰©å“
  default: true

foliashop.gacha.use:    # ä½¿ç”¨æ‰­è›‹åŠŸèƒ½
  default: true
```

### ç®¡ç†å‘˜æƒé™
```yaml
foliashop.admin:        # ç®¡ç†å‘˜æƒé™ï¼ˆç¼–è¾‘å•†åº—ã€é‡è½½é…ç½®ç­‰ï¼‰
  default: op
```

### æƒé™ç»§æ‰¿å…³ç³»
```
foliashop.admin
  â””â”€ åŒ…å«æ‰€æœ‰å…¶ä»–æƒé™

foliashop.use
  â””â”€ foliashop.shop.use
  â””â”€ foliashop.gacha.use
```

## ğŸ‘‘ ç®¡ç†å‘˜åŠŸèƒ½

### å•†åº—ç‰©å“ç®¡ç†
ç®¡ç†å‘˜å¯ä»¥é€šè¿‡ `/foliashop admin` å‘½ä»¤æ‰“å¼€å•†åº—ç®¡ç†ç•Œé¢ï¼Œå¯¹å•ä¸ªç‰©å“è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| ğŸ“¦ åº“å­˜è°ƒæ•´ | +1, +10, +64, -1, -10, è®¾ä¸ºæ— é™ |
| ğŸ—‘ï¸ **æ¸…ç©ºåº“å­˜** | å°†åº“å­˜è®¾ä¸º 0 |
| ğŸ”„ **ä»é…ç½®æ–‡ä»¶é‡ç½®** | ä» `config.yml` é‡æ–°åŠ è½½è¯¥ç‰©å“çš„æ‰€æœ‰é…ç½® |
| âŒ **åˆ é™¤ç‰©å“** | ä»æ•°æ®åº“ä¸­æ°¸ä¹…åˆ é™¤è¯¥å•†åº—ç‰©å“ï¼ˆå¸¦ç¡®è®¤å¯¹è¯æ¡†ï¼‰ |

### æ•°æ®æ¸…ç†
ç®¡ç†å‘˜å¯ä»¥ä½¿ç”¨ `/foliashop clean <å¤©æ•°>` å‘½ä»¤æ¸…ç†æ—§æ•°æ®ï¼š

```bash
/foliashop clean 5    # æ¸…ç†5å¤©ä»¥å‰çš„æ•°æ®
/foliashop clean 10   # æ¸…ç†10å¤©ä»¥å‰çš„æ•°æ®
/foliashop clean 30   # æ¸…ç†30å¤©ä»¥å‰çš„æ•°æ®
```

**æ¸…ç†çš„æ•°æ®ç±»å‹ï¼š**
- äº¤æ˜“è®°å½•
- æŠ½å¥–è®°å½•
- è¿‡æœŸè´­ä¹°è®¡æ•°

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®
```yaml
# æ•°æ®åº“é…ç½®
database:
  type: H2  # å¯é€‰: H2, MYSQL
  host: localhost
  port: 3306
  name: foliashop
  user: root
  password: password

# ç»æµè®¾ç½®
currency:
  name: "é‡‘å¸"
  symbol: "Â§eğŸ’°"

# å•†åº—è®¾ç½®
shop:
  sell-system:
    enabled: true
    mode: ALL  # SHOP_ONLY, CONFIG_ONLY, ALL
```

### å•†å“é…ç½®ç¤ºä¾‹
```yaml
shop:
  items:
    diamond_shop:
      item: "minecraft:diamond"  # åŸç‰ˆç‰©å“
      buy-price: 100.0
      sell-price: 50.0
      stock: -1        # -1è¡¨ç¤ºæ— é™åº“å­˜
      daily-limit: 10  # æ¯æ—¥è´­ä¹°é™é¢ï¼ˆ0è¡¨ç¤ºæ— é™åˆ¶ï¼‰
      category: "misc"
      slot: 11
    magic_sword_shop:
      item: "craftengine:magic_sword"  # CEç‰©å“
      buy-price: 1000.0
      sell-price: 0.0  # 0è¡¨ç¤ºä¸å¯å‡ºå”®
      stock: 10
      daily-limit: 0   # æ— è´­ä¹°é™åˆ¶
      category: "tools"
      slot: 13
```

### æ‰­è›‹æœºé…ç½®ç¤ºä¾‹
```yaml
gacha:
  machines:
    normal:
      name: "æ™®é€šæ‰­è›‹æœº"
      cost: 100.0
      animation-duration: 3      # å•æŠ½åŠ¨ç”»æ—¶é•¿ï¼ˆç§’ï¼‰
      animation-duration-ten: 9  # 10è¿æŠ½åŠ¨ç”»æ—¶é•¿ï¼ˆç§’ï¼‰
      broadcast-rare: true
      broadcast-threshold: 0.05  # æ¦‚ç‡ä½äºæ­¤å€¼æ—¶å¹¿æ’­
      # å¤šæ®µä¿åº•é…ç½®ï¼ˆå¯é€‰ï¼‰
      pity-rules:
        - count: 10              # 10æŠ½ä¿åº•
          max-probability: 0.1   # æ¦‚ç‡â‰¤0.1çš„å¥–å“æ± 
        - count: 50              # 50æŠ½ä¿åº•
          max-probability: 0.03  # æ¦‚ç‡â‰¤0.03çš„å¥–å“æ± 
        - count: 90              # 90æŠ½ä¿åº•
          max-probability: 0.01  # æ¦‚ç‡â‰¤0.01çš„å¥–å“æ± 
      rewards:
        - id: "reward_1"
          item: "minecraft:diamond"
          amount: 2
          probability: 0.08
          display-name: "é’»çŸ³ç¤¼åŒ…"
          broadcast: true
```

**å¤šæ®µä¿åº•è¯´æ˜**ï¼š
- æ¯ä¸ªè§„åˆ™ä½¿ç”¨ `count_maxProbability` ä½œä¸ºå”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ `10_0.10`ï¼‰
- å„è§„åˆ™ç‹¬ç«‹è®¡æ•°ï¼Œäº’ä¸å½±å“
- ä¼˜å…ˆè§¦å‘é«˜æ¡£æ¬¡ä¿åº•ï¼ˆæŒ‰ count é™åºæ£€æŸ¥ï¼‰
- è§¦å‘ä¿åº•åè¯¥è§„åˆ™è®¡æ•°é‡ç½®ä¸º0ï¼Œå…¶ä»–è§„åˆ™ç»§ç»­ç´¯ç§¯

## ğŸ› ï¸ æ„å»º

```bash
./gradlew shadowJar
```

æ„å»ºåçš„ JAR æ–‡ä»¶ä½äº `build/libs/folia_shop-1.0.0.jar`

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
folia_shop/
â”œâ”€â”€ build.gradle.kts              # Gradleæ„å»ºé…ç½®
â”œâ”€â”€ settings.gradle.kts
â”œâ”€â”€ gradlew
â”œâ”€â”€ gradle/wrapper/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main/
â”‚       â”œâ”€â”€ java/dev/user/shop/
â”‚       â”‚   â”œâ”€â”€ FoliaShopPlugin.java
â”‚       â”‚   â”œâ”€â”€ command/          # å‘½ä»¤å¤„ç†
â”‚       â”‚   â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ database/         # æ•°æ®åº“
â”‚       â”‚   â”œâ”€â”€ economy/          # ç»æµç³»ç»Ÿ (XConomy API)
â”‚       â”‚   â”œâ”€â”€ gacha/            # æ‰­è›‹ç³»ç»Ÿ
â”‚       â”‚   â”œâ”€â”€ gui/              # GUIç•Œé¢
â”‚       â”‚   â”œâ”€â”€ listener/         # äº‹ä»¶ç›‘å¬
â”‚       â”‚   â”œâ”€â”€ shop/             # å•†åº—ç³»ç»Ÿ
â”‚       â”‚   â””â”€â”€ util/             # å·¥å…·ç±» (CraftEngine API)
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ plugin.yml
â”‚           â””â”€â”€ config.yml
â””â”€â”€ README.md
```

## ğŸ“¦ ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | æ¥æº |
|------|------|------|
| Folia-API | 1.21.11-R0.1-SNAPSHOT | PaperMC |
| XConomyAPI | 2.25.1 | JitPack |
| CraftEngine | 0.0.67 | Momirealms |
| HikariCP | 6.2.1 | Maven Central |
| H2 | 2.3.232 | Maven Central |
| MySQL Connector | 9.2.0 | Maven Central |

## ğŸ“„ è®¸å¯è¯

MIT License

---

**æ³¨æ„**ï¼šæœ¬æ’ä»¶ä¸“ä¸º Folia/Paper æœåŠ¡ç«¯è®¾è®¡ã€‚
